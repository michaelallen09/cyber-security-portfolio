# 5. IDS/IPS Testing and Detection Evaluation

This section evaluates the effectiveness of intrusion detection and prevention mechanisms during the MitC attack simulation. The objective was to determine whether reconnaissance, exploitation, and post-exploitation activity could be detected or blocked.

## 5.1 Tools Evaluated

The following tools were deployed and tested:

- **Snort IDS/IPS**
- **Suricata**
- **Kali Purple IDS components**

These tools were configured within the lab to monitor internal traffic between the attacker VM, Windows client, and cloud services.

## 5.2 Detection of Reconnaissance Activity

During initial scanning, intrusion detection alerts were triggered.

### Example Activity
```bash
nmap -sV -p- 192.168.1.10
```

### Detection Results
- Snort successfully detected SYN scan behaviour
- Nmap scanning activity generated alerts
- Reconnaissance activity was visible in logs

This confirmed that baseline scanning behaviour was detectable.

## 5.3 Detection of Brute-Force and SMB Exploitation

Credential brute-forcing and SMB exploitation were performed using Hydra and Metasploit.

### Observations
- Some SMB-related traffic was logged
- Brute-force activity was partially visible
- No automatic blocking occurred
- IPS functionality was limited due to configuration and resource constraints

Detection existed, but prevention was not consistently enforced.

## 5.4 Post-Exploitation and Token Extraction

Activities such as:

- Meterpreter session establishment
- Mimikatz execution
- Token extraction
- Curl-based API requests

were not consistently flagged by detection tools.

This demonstrated that while reconnaissance was visible, post-authentication abuse and token-based access were more difficult to detect.

## 5.5 Limitations Identified

Several factors reduced detection effectiveness:

- Limited rule tuning
- Resource constraints within the virtual environment
- IDS operating primarily in detection mode rather than strict prevention
- Encrypted or legitimate-looking API traffic blending with normal sync behaviour

These limitations reflect real-world scenarios where monitoring tools are deployed but not fully optimised.

## 5.6 Summary

The IDS/IPS evaluation showed:

- Reconnaissance activity was detectable
- Brute-force attempts were partially visible
- Post-exploitation and token abuse were minimally detected
- IPS enforcement was limited

The results highlighted the importance of proper configuration, rule tuning, and layered security controls to prevent token-based cloud compromise.
